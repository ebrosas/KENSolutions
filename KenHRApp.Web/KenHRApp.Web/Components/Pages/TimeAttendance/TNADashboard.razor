@page "/TimeAttendance/tnadashboard"

<MudText Typo="Typo.subtitle1" Align="Align.Left" Class="pb-1 ps-4 fw-bolder" Style="color: #004165;">Employee Attendance Dashboard</MudText>
<MudContainer MaxWidth="MaxWidth.False" Class="px-4">
    @if (_showErrorAlert)
    {
        <MudAlert Severity="Severity.Error" Variant="Variant.Filled" ContentAlignment="HorizontalAlignment.Left"
                  ShowCloseIcon="true" CloseIconClicked="(() => ShowHideError(false))">
            @_errorMessage
        </MudAlert>
    }
    <div id="mainPanel" class="ma-0 full-height" style="overflow-y: scroll; scrollbar-width: none;">
        <MudBreadcrumbs Items="@_breadcrumbItems" SeparatorIcon="@Icons.Material.Filled.ChevronRight"
            CollapseIcon="@Icons.Material.Filled.MoreHoriz" MaxItems="4" Class="mud-breadcrumbs" />
        <MudGrid Spacing="0" Class="mt-2">
            <MudItem xs="3" Class="ps-0 pe-4">
                <MudStack AlignItems="AlignItems.Start" Spacing="0" Wrap="Wrap.NoWrap">
                    <MudPaper Elevation="0" Class="p-0 w-100">
                        <MudDatePicker PickerVariant="PickerVariant.Static" Color="Color.Default"
                                       Rounded="true" Elevation="1" Date="@(DateTime.Today)" />
                    </MudPaper>
                </MudStack>
                <MudStack Row="true" AlignItems="AlignItems.Start" Spacing="0" Wrap="Wrap.Wrap">
                    <MudChipSet T="string" Class="mt-4" ReadOnly="true">
                        @foreach (var legend in AttendanceLegends)
                        {
                            <MudChip
                                Icon="@Icons.Material.Filled.Circle"
                                IconColor="@GetLegendColor(legend.UDCCode)"
                                Size="Size.Small"
                                Variant="Variant.Text">
                                @legend.UDCDesc1
                            </MudChip>
                        }
                    </MudChipSet>
                </MudStack>
            </MudItem>
            <MudItem xs="4" Class="px-4">
                <MudStack>
                    <MudPaper Class="pa-4" Elevation="4" Square="true">
                        <MudStack Row="true" AlignItems="AlignItems.Start" Justify="Justify.FlexStart" StretchItems="StretchItems.Start">
                            <MudStack>
                                <MudStack Row="true">
                                    <MudAvatar Size="Size.Large" Color="Color.Success" Variant="Variant.Outlined">
                                        <MudIcon Icon="@Icons.Material.Filled.HourglassTop" Size="Size.Large" />
                                    </MudAvatar>
                                    <MudStack Justify="Justify.Center" Spacing="0">
                                        <MudText Typo="Typo.h6">0:00 hrs</MudText>
                                        <MudText Typo="Typo.caption">Spent Today</MudText>
                                    </MudStack>
                                </MudStack>
                                <MudStack AlignItems="AlignItems.Start" Spacing="0" Class="pa-1">
                                    <MudText Typo="Typo.body2">0 Absences in this month</MudText>
                                    <MudText Typo="Typo.body2">36.5 Annual Leave available</MudText>
                                </MudStack>
                                <MudPaper Elevation="0">
                                    <MudButton Variant="Variant.Outlined" Color="Color.Secondary" Size="Size.Small" DropShadow="true">Extra Time</MudButton>
                                </MudPaper>
                            </MudStack>
                            <MudStack Justify="Justify.Center" Spacing="2">
                                <MudButton Variant="Variant.Filled" Color="Color.Info" Size="Size.Small" DropShadow="true">Apply Leave</MudButton>
                                <MudButton Variant="Variant.Filled" Color="Color.Info" Size="Size.Small" DropShadow="true">Regularize</MudButton>
                                <MudButton Variant="Variant.Filled" Color="Color.Info" Size="Size.Small" DropShadow="true">Apply Outdoor</MudButton>
                            </MudStack>
                        </MudStack>
                    </MudPaper>
                    <MudPaper Elevation="4" Class="p-4 w-100" Square="true">
                        <MudStack>
                            <MudStack Spacing="0" Class="pa-0">
                                <MudText Typo="Typo.h6">Leave Balance</MudText>
                                <MudText Typo="Typo.caption">Tap on Leave Type Balance to apply for leave</MudText>
                            </MudStack>
                            <MudStack Row="true" AlignItems="AlignItems.Start" Justify="Justify.Center" StretchItems="StretchItems.All">
                                <MudStack AlignItems="AlignItems.Center" Justify="Justify.Center" StretchItems="StretchItems.All" Spacing="2">
                                    <MudButton Variant="Variant.Filled" Color="Color.Success" FullWidth="true"
                                        Size="Size.Large" DropShadow="true">
                                        36.00
                                    </MudButton>
                                    <MudText Typo="Typo.caption">Annual Leave</MudText>
                                </MudStack>
                                <MudStack AlignItems="AlignItems.Center" Justify="Justify.Center" StretchItems="StretchItems.All" Spacing="2">
                                    <MudButton Variant="Variant.Filled" Color="Color.Secondary" FullWidth="true"
                                        Size="Size.Large" DropShadow="true">
                                        3.00
                                    </MudButton>
                                    <MudText Typo="Typo.caption">Sick Leave</MudText>
                                </MudStack>
                                <MudStack AlignItems="AlignItems.Center" Justify="Justify.Center" StretchItems="StretchItems.All" Spacing="2">
                                    <MudButton Variant="Variant.Filled" Color="Color.Warning" FullWidth="true"
                                        Size="Size.Large" DropShadow="true">
                                        1.00
                                    </MudButton>
                                    <MudText Typo="Typo.caption">Day In Lieu</MudText>
                                </MudStack>
                            </MudStack>
                        </MudStack>
                    </MudPaper>
                </MudStack>
            </MudItem>
            <MudItem xs="5" Class="px-3">
                <MudStack>
                    <MudPaper Class="pa-4" Elevation="4" Square="true">
                        <MudStack Row="true" AlignItems="AlignItems.Start" Justify="Justify.Center" StretchItems="StretchItems.All" Spacing="3">
                            <MudStack AlignItems="AlignItems.Center" Justify="Justify.FlexStart" StretchItems="StretchItems.All" Spacing="3">
                                <MudStack Justify="Justify.Center" Spacing="0">
                                    <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly" Spacing="1">
                                        <MudAvatar Size="Size.Medium" Color="Color.Error" Variant="Variant.Filled">
                                            <MudIcon Icon="@Icons.Material.Filled.WorkOff" />
                                        </MudAvatar>
                                        <MudText Typo="Typo.h6" Color="Color.Error">0</MudText>
                                    </MudStack>
                                    <MudText Typo="Typo.caption" Align="Align.Center">Absents</MudText>
                                </MudStack>
                                <MudStack Justify="Justify.Center" Spacing="0">
                                    <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly" Spacing="1">
                                        <MudAvatar Size="Size.Small" Color="Color.Default" Variant="Variant.Outlined">
                                            <MudIcon Icon="@Icons.Material.Filled.WatchLater" />
                                        </MudAvatar>
                                        <MudText Typo="Typo.h6">0</MudText>
                                    </MudStack>
                                    <MudText Typo="Typo.caption" Align="Align.Center">Late</MudText>
                                </MudStack>
                                <MudStack Justify="Justify.Center" Spacing="0">
                                    <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly" Spacing="1">
                                        <MudAvatar Size="Size.Small" Color="Color.Default" Variant="Variant.Outlined">
                                            <MudIcon Icon="@Icons.Material.Filled.NetworkCheck" />
                                        </MudAvatar>
                                        <MudText Typo="Typo.h6">0</MudText>
                                    </MudStack>
                                    <MudText Typo="Typo.caption" Align="Align.Center">Total WH</MudText>
                                </MudStack>
                            </MudStack>
                            <MudStack AlignItems="AlignItems.Center" Justify="Justify.FlexStart" StretchItems="StretchItems.All" Spacing="3">
                                <MudStack Justify="Justify.Center" Spacing="0">
                                    <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly" Spacing="1">
                                        <MudAvatar Size="Size.Medium" Color="Color.Success" Variant="Variant.Filled">
                                            <MudIcon Icon="@Icons.Material.Filled.TimeToLeave" />
                                        </MudAvatar>
                                        <MudText Typo="Typo.h6" Color="Color.Success">0</MudText>
                                    </MudStack>
                                    <MudText Typo="Typo.caption" Align="Align.Center">On Leave</MudText>
                                </MudStack>
                                <MudStack Justify="Justify.Center" Spacing="0">
                                    <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly" Spacing="1">
                                        <MudAvatar Size="Size.Small" Color="Color.Default" Variant="Variant.Outlined">
                                            <MudIcon Icon="@Icons.Material.Filled.Logout" />
                                        </MudAvatar>
                                        <MudText Typo="Typo.h6">0</MudText>
                                    </MudStack>
                                    <MudText Typo="Typo.caption" Align="Align.Center">Early Out</MudText>
                                </MudStack>
                                <MudStack Justify="Justify.Center" Spacing="0">
                                    <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly" Spacing="1">
                                        <MudAvatar Size="Size.Small" Color="Color.Default" Variant="Variant.Outlined">
                                            <MudIcon Icon="@Icons.Material.Filled.Today" />
                                        </MudAvatar>
                                        <MudText Typo="Typo.h6">0</MudText>
                                    </MudStack>
                                    <MudText Typo="Typo.caption" Align="Align.Center">Days Worked</MudText>
                                </MudStack>
                            </MudStack>
                            <MudStack AlignItems="AlignItems.Center" Justify="Justify.FlexStart" StretchItems="StretchItems.All" Spacing="3">
                                <MudStack Justify="Justify.Center" Spacing="0">
                                    <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly" Spacing="1">
                                        <MudAvatar Size="Size.Medium" Color="Color.Tertiary" Variant="Variant.Filled">
                                            <MudIcon Icon="@Icons.Material.Filled.ViewDay" />
                                        </MudAvatar>
                                        <MudText Typo="Typo.h6" Color="Color.Tertiary">0</MudText>
                                    </MudStack>
                                    <MudText Typo="Typo.caption" Align="Align.Center">Half Days</MudText>
                                </MudStack>
                                <MudStack Justify="Justify.Center" Spacing="0">
                                    <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly" Spacing="1">
                                        <MudAvatar Size="Size.Small" Color="Color.Default" Variant="Variant.Outlined">
                                            <MudIcon Icon="@Icons.Material.Filled.IncompleteCircle" />
                                        </MudAvatar>
                                        <MudText Typo="Typo.h6">0</MudText>
                                    </MudStack>
                                    <MudText Typo="Typo.caption" Align="Align.Center">Deficit Hours</MudText>
                                </MudStack>
                                <MudStack Justify="Justify.Center" Spacing="0">
                                    <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.SpaceEvenly" Spacing="1">
                                        <MudAvatar Size="Size.Small" Color="Color.Default" Variant="Variant.Outlined">
                                            <MudIcon Icon="@Icons.Material.Filled.BarChart" />
                                        </MudAvatar>
                                        <MudText Typo="Typo.h6">0</MudText>
                                    </MudStack>
                                    <MudText Typo="Typo.caption" Align="Align.Center">Avg. WH</MudText>
                                </MudStack>
                            </MudStack>
                        </MudStack>
                    </MudPaper>
                    <MudPaper Class="pa-4" Elevation="4" Square="true">
                        <MudStack AlignItems="AlignItems.Start" Justify="Justify.FlexStart">
                            <MudStack Row="true" AlignItems="AlignItems.Start" Justify="Justify.FlexStart" StretchItems="StretchItems.End" Spacing="3" Class="pa-0">
                                <!-- Pagination -->
                                <MudPagination Class="mt-4"
                                               Variant="Variant.Filled"
                                               Rectangular="false"
                                               Color="Color.Default"
                                               Size="Size.Medium"
                                               ShowFirstButton="true" ShowLastButton="true"
                                               Count="@pageCount"
                                               SelectedChanged="OnPageChanged" />
                                <MudSelect T="int" @bind-Value="pageSize" Dense="true" Label="Items per page">
                                    <MudSelectItem Value="5">5</MudSelectItem>
                                    <MudSelectItem Value="10">10</MudSelectItem>
                                    <MudSelectItem Value="20">20</MudSelectItem>
                                </MudSelect>
                            </MudStack>                            
                            <MudList T="HolidayDTO" Dense="true">
                                @if (!HolidayList.Any())
                                {
                                    <MudText Typo="Typo.caption" Color="Color.Secondary">
                                        No public holidays found for the selected year.
                                    </MudText>
                                }
                                @foreach (var holiday in PagedHolidays)
                                {
                                    <MudListItem Icon="@Icons.Material.Filled.Event" Color="@(holiday.HolidayDate.DayOfWeek is DayOfWeek.Saturday or DayOfWeek.Sunday ? Color.Error: Color.Primary)">
                                        <MudStack Spacing="1">
                                            <!-- Holiday Date -->
                                            <MudText Typo="Typo.subtitle2">
                                                @holiday.HolidayDate.ToString("dd MMM yyyy")
                                            </MudText>

                                            <!-- Holiday Description -->
                                            <MudText Typo="Typo.body1" Class="fw-600">
                                                @holiday.HolidayDesc
                                            </MudText>

                                            <!-- Day of Week -->
                                            <MudText Typo="Typo.caption" Color="Color.Secondary">
                                                @holiday.HolidayDate.ToString("dddd")
                                            </MudText>

                                        </MudStack>
                                    </MudListItem>
                                }
                            </MudList>
                        </MudStack>                                            
                    </MudPaper>
                </MudStack>                
            </MudItem>
        </MudGrid>
        <MudScrollToTop TopOffset="100"
                        Selector="#mainPanel"
                        VisibleCssClass="visible absolute"
                        HiddenCssClass="hidden absolute">
            <MudButton Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.ArrowUpward" Color="Color.Error">Go to top</MudButton>
        </MudScrollToTop>
    </div>
</MudContainer>